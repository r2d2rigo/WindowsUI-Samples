using CustomItemContainerTransitions.Models;
using Newtonsoft.Json.Linq;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Text;
using System.Threading.Tasks;

namespace CustomItemContainerTransitions.DataAccess
{
    public class RandomUserRepository
    {
        public async Task<List<UserProfile>> GetRandomUsersAsync()
        {
            var users = new List<UserProfile>();

            using (var httpClient = new HttpClient())
            {
#if DEBUG
                var requestContent = @"{""results"":[{""gender"":""male"",""name"":{""title"":""mr"",""first"":""ross"",""last"":""walters""},""location"":{""street"":""3170 oak lawn ave"",""city"":""orange"",""state"":""nebraska"",""postcode"":58854},""email"":""ross.walters@example.com"",""login"":{""username"":""whiteduck267"",""password"":""tong"",""salt"":""g1uJrpJP"",""md5"":""939ce0795ea7005e05367172520e126f"",""sha1"":""7f98ed9f0d08fbbf3948805715bdcac91e161f7c"",""sha256"":""3828b0c69e4bdfa68877ee9fbf3f3e4a60a981f15753227f937ed0e4c4b6d26b""},""registered"":1263170129,""dob"":1105508751,""phone"":""(140)-134-0404"",""cell"":""(170)-153-5166"",""id"":{""name"":""SSN"",""value"":""124-42-4644""},""picture"":{""large"":""https://randomuser.me/api/portraits/men/94.jpg"",""medium"":""https://randomuser.me/api/portraits/med/men/94.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/men/94.jpg""},""nat"":""US""},{""gender"":""female"",""name"":{""title"":""miss"",""first"":""melinda"",""last"":""duncan""},""location"":{""street"":""5030 ash dr"",""city"":""duncanville"",""state"":""michigan"",""postcode"":62214},""email"":""melinda.duncan@example.com"",""login"":{""username"":""redkoala653"",""password"":""billy1"",""salt"":""LQrQHzs7"",""md5"":""0bd85b0d9f8464787a4e6975f27a1366"",""sha1"":""48790ad799d37ebd17254e21721685fa5f7c32d3"",""sha256"":""51ed743b0b0ab9dfeceeb554c8839ee160240bcf75a817b77f8bdcb5b67fb916""},""registered"":1422048126,""dob"":661974734,""phone"":""(168)-120-5456"",""cell"":""(627)-367-7330"",""id"":{""name"":""SSN"",""value"":""147-66-7148""},""picture"":{""large"":""https://randomuser.me/api/portraits/women/78.jpg"",""medium"":""https://randomuser.me/api/portraits/med/women/78.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/women/78.jpg""},""nat"":""US""},{""gender"":""female"",""name"":{""title"":""ms"",""first"":""rebecca"",""last"":""washington""},""location"":{""street"":""7929 james st"",""city"":""montgomery"",""state"":""texas"",""postcode"":32732},""email"":""rebecca.washington@example.com"",""login"":{""username"":""silverladybug668"",""password"":""flash"",""salt"":""tkl4YXHW"",""md5"":""6c8f2e3ad0ac61e2a91e851e5df7bb72"",""sha1"":""75c2a523904c1f80ab2a29cb398a2c95c12c4fad"",""sha256"":""8b9f7f6853a38194255a8f0b87db5aa0cb4ffdebed31e7ee988e3d7fec636bc7""},""registered"":998052035,""dob"":1184829802,""phone"":""(692)-895-8113"",""cell"":""(241)-020-7559"",""id"":{""name"":""SSN"",""value"":""725-52-8164""},""picture"":{""large"":""https://randomuser.me/api/portraits/women/73.jpg"",""medium"":""https://randomuser.me/api/portraits/med/women/73.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/women/73.jpg""},""nat"":""US""},{""gender"":""male"",""name"":{""title"":""mr"",""first"":""lawrence"",""last"":""rogers""},""location"":{""street"":""6376 dane st"",""city"":""palm bay"",""state"":""alabama"",""postcode"":81654},""email"":""lawrence.rogers@example.com"",""login"":{""username"":""bluemeercat362"",""password"":""pantie"",""salt"":""vufRjUUl"",""md5"":""929bfce33339626fb946d52bc7a3f04b"",""sha1"":""187fcb635adf4fca2c1aeb6c4d6faba81a26cdc1"",""sha256"":""06e4104212596383890e10754fcd0520a5fa3b7e77c03fb4bfb48eb13aee3067""},""registered"":954108449,""dob"":1027704519,""phone"":""(884)-994-4366"",""cell"":""(191)-505-2028"",""id"":{""name"":""SSN"",""value"":""416-15-6919""},""picture"":{""large"":""https://randomuser.me/api/portraits/men/48.jpg"",""medium"":""https://randomuser.me/api/portraits/med/men/48.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/men/48.jpg""},""nat"":""US""},{""gender"":""female"",""name"":{""title"":""miss"",""first"":""margie"",""last"":""richards""},""location"":{""street"":""3768 mcclellan rd"",""city"":""coral springs"",""state"":""alaska"",""postcode"":80956},""email"":""margie.richards@example.com"",""login"":{""username"":""whiteduck267"",""password"":""beatles"",""salt"":""5NLgtbfh"",""md5"":""35ac48f0cb2b618b436da180b24a3f4d"",""sha1"":""02aa605e6bec02bb0ee4a8a9ced523c9f7637b5d"",""sha256"":""16098dc37dae0686458e75559179f11967a17b69f9871e29984e7e72ede730c5""},""registered"":1005295845,""dob"":1270784094,""phone"":""(118)-253-0233"",""cell"":""(531)-453-2137"",""id"":{""name"":""SSN"",""value"":""693-33-0022""},""picture"":{""large"":""https://randomuser.me/api/portraits/women/12.jpg"",""medium"":""https://randomuser.me/api/portraits/med/women/12.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/women/12.jpg""},""nat"":""US""},{""gender"":""female"",""name"":{""title"":""ms"",""first"":""felicia"",""last"":""hughes""},""location"":{""street"":""2519 frances ct"",""city"":""oxnard"",""state"":""colorado"",""postcode"":56727},""email"":""felicia.hughes@example.com"",""login"":{""username"":""organicfish124"",""password"":""litle"",""salt"":""YouOmGUb"",""md5"":""3ec21ef90f95f7f89cf969fd3b6e6601"",""sha1"":""303fb2875090262c408725f2f1772545d2f73e3c"",""sha256"":""1293fc74df4fd960debf0f245e52ef66039cc8bb30943931ba1d6c4d69606810""},""registered"":1396095337,""dob"":1314230155,""phone"":""(097)-696-2568"",""cell"":""(256)-605-0110"",""id"":{""name"":""SSN"",""value"":""691-00-7599""},""picture"":{""large"":""https://randomuser.me/api/portraits/women/79.jpg"",""medium"":""https://randomuser.me/api/portraits/med/women/79.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/women/79.jpg""},""nat"":""US""},{""gender"":""male"",""name"":{""title"":""mr"",""first"":""dave"",""last"":""wade""},""location"":{""street"":""5596 oak lawn ave"",""city"":""torrance"",""state"":""montana"",""postcode"":89393},""email"":""dave.wade@example.com"",""login"":{""username"":""lazyfish252"",""password"":""brian"",""salt"":""qqZ2yL5y"",""md5"":""f645bc9fbb4412191ab37ce1d79b3d83"",""sha1"":""57cbae2b129ec9ce4d55d50d4eab7f26fd30bb08"",""sha256"":""8595c65c6f0026fc23a529882a46ae5e5bd18275b6ea5289ae83042e021688a0""},""registered"":1253516894,""dob"":16526370,""phone"":""(916)-574-7031"",""cell"":""(647)-979-0583"",""id"":{""name"":""SSN"",""value"":""134-75-2988""},""picture"":{""large"":""https://randomuser.me/api/portraits/men/82.jpg"",""medium"":""https://randomuser.me/api/portraits/med/men/82.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/men/82.jpg""},""nat"":""US""},{""gender"":""male"",""name"":{""title"":""mr"",""first"":""derrick"",""last"":""gordon""},""location"":{""street"":""3637 photinia ave"",""city"":""wichita"",""state"":""colorado"",""postcode"":11205},""email"":""derrick.gordon@example.com"",""login"":{""username"":""yellowkoala676"",""password"":""seabee"",""salt"":""5cdvgfGw"",""md5"":""acca3a63b5a6d766aba2ffd7958ebab5"",""sha1"":""04dbca83564d3bb1f39fa3b26be3b526cdea373d"",""sha256"":""da754d1c334e02b8aac0148239f53f714712564d993389a9dabeba990f253ef9""},""registered"":1327799660,""dob"":904164237,""phone"":""(091)-902-0373"",""cell"":""(869)-061-1500"",""id"":{""name"":""SSN"",""value"":""646-33-2412""},""picture"":{""large"":""https://randomuser.me/api/portraits/men/73.jpg"",""medium"":""https://randomuser.me/api/portraits/med/men/73.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/men/73.jpg""},""nat"":""US""},{""gender"":""female"",""name"":{""title"":""mrs"",""first"":""ava"",""last"":""warren""},""location"":{""street"":""1304 central st"",""city"":""santa ana"",""state"":""alaska"",""postcode"":13999},""email"":""ava.warren@example.com"",""login"":{""username"":""crazymouse329"",""password"":""chestnut"",""salt"":""3DaaqkhJ"",""md5"":""efd65de5572ba96d2d22852b4f0b7f5a"",""sha1"":""a06df2b46e20912bd83f8d11e9b00832d5006bdb"",""sha256"":""2ea40fa3b36037b67b04b468ec9bb9ce234570daf19279d5d96ad2db4183884b""},""registered"":1194034460,""dob"":1012087028,""phone"":""(785)-803-7107"",""cell"":""(318)-570-1994"",""id"":{""name"":""SSN"",""value"":""753-31-3170""},""picture"":{""large"":""https://randomuser.me/api/portraits/women/48.jpg"",""medium"":""https://randomuser.me/api/portraits/med/women/48.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/women/48.jpg""},""nat"":""US""},{""gender"":""female"",""name"":{""title"":""mrs"",""first"":""toni"",""last"":""perry""},""location"":{""street"":""4509 white oak dr"",""city"":""lewiston"",""state"":""utah"",""postcode"":54240},""email"":""toni.perry@example.com"",""login"":{""username"":""smalllion239"",""password"":""clovis"",""salt"":""woy9LOom"",""md5"":""218deced5b01198345080679ab92ae18"",""sha1"":""78ee03c230b08dfafc2d9817add62887d4b6c293"",""sha256"":""da26739bd2a0a0c6ee89bd2cc05f278f1213a374163ba3840d935e472769b802""},""registered"":1333345803,""dob"":1004353964,""phone"":""(849)-311-5609"",""cell"":""(259)-231-4727"",""id"":{""name"":""SSN"",""value"":""388-51-3713""},""picture"":{""large"":""https://randomuser.me/api/portraits/women/49.jpg"",""medium"":""https://randomuser.me/api/portraits/med/women/49.jpg"",""thumbnail"":""https://randomuser.me/api/portraits/thumb/women/49.jpg""},""nat"":""US""}],""info"":{""seed"":""WindowsUI"",""results"":10,""page"":1,""version"":""1.0""}}";
#else
                var requestContent = await httpClient.GetStringAsync("https://randomuser.me/api?dataType=json&results=10&nat=US&seed=WindowsUI");
#endif

                var jObject = JObject.Parse(requestContent);
                var results = jObject["results"];

                var newUsers = results.Children().Select(t => new UserProfile()
                {
                    FullName = string.Format("{0} {1}", (string)t["name"]["first"], (string)t["name"]["last"]),
                    EmailAddress = (string)t["email"],
                    MobilePhoneNumber = (string)t["cell"],
                    ProfileImage = (string)t["picture"]["large"],
                });

                for (int i = 0; i < 100; i++)
                users.AddRange(newUsers);
            }

            return users;
        }
    }
}
